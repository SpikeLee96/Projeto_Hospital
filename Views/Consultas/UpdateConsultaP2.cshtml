@model Projeto_CRUD.Models.Consulta
@{
    ViewData["Title"] = "Home Page";
    Consulta consulta = new Consulta();
    foreach (var c in ViewBag.listaConsultas)
    {
        if (c.id == ViewBag.idConsulta)
        {
            consulta = c;
        }
    }

    string nomePaciente = " ";
    foreach (var p in ViewBag.listaPacientes)
    {
        if (p.id == consulta.PacienteId)
        {
            nomePaciente = p.nome;
        }
    }

    TipoExame tipoExame = new TipoExame();
    foreach (var t in ViewBag.listaTipoExames)
    {
        if (t.id == ViewBag.idTipoExame)
        {
            tipoExame = t;
        }
    }

    Exame exame = new Exame();
    foreach (var e in ViewBag.listaExames)
    {
        if (e.TipoExameId == ViewBag.idTipoExame)
        {
            exame = e;
        }
    }

    List<SelectListItem> idConsulta = new List<SelectListItem>();
    idConsulta.Add(new SelectListItem { Text = consulta.id.ToString(), Value = consulta.id.ToString() });
    List<SelectListItem> idPaciente = new List<SelectListItem>();
    idPaciente.Add(new SelectListItem { Text = consulta.PacienteId.ToString(), Value = consulta.PacienteId.ToString() });
}

<section class="h-100 h-custom" style="background-color: #b30000;">
    <div class="container py-5 h-100">
        <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col-lg-8 col-xl-6">
                <div class="card rounded-3">
                    <img src='~/resources/hospital.jpg' height="180" class="w-100" style="border-top-left-radius: .3rem; border-top-right-radius: .3rem;" alt="Sample photo">
                    <div class="card-body p-4 p-md-5">
                        <h3 class="mb-4 pb-2 pb-md-0 mb-md-5 px-md-2">Editar consulta</h3>

                        @using (Html.BeginForm("UpdateConsultaP2", "Consultas", FormMethod.Post, new { @class = "px-md-2" }))
                        {
                            @Html.AntiForgeryToken()
                            @Html.DropDownListFor(model => model.id, idConsulta)

                            <script type="text/javascript">
                                document.getElementById("id").hidden = true
                            </script>

                            <div class="row">
                                <div class="col-md-6 mb-4">
                                    @Html.Label("", "Nome do paciente", new { @class = "form-label", @style = "font-weight: bold" })
                                    @Html.Label("", nomePaciente, new { @class = "form-label" })
                                    @Html.DropDownListFor(model => model.PacienteId, idPaciente)

                                    <script type="text/javascript">
                                        document.getElementById("PacienteId").hidden = true
                                    </script>

                                </div>
                            </div>

                            <div class="row">
                                <div class="col-md-6 mb-4">
                                    @Html.Label("", "Tipo do exame", new { @class = "form-label", @style = "font-weight: bold" }) <br />
                                    @Html.Label("", tipoExame.tipo, new { @class = "form-label" })
                                </div>
                            </div>

                            <div class="row">
                                <div class="col mb-4">
                                    @Html.Label("", "Exame", new { @class = "form-label", @style = "font-weight: bold" })
                                    <div class="form-outline datepicker">
                                        @{
                                            List<SelectListItem> listExames = new List<SelectListItem>();

                                            foreach (var e in ViewBag.listaExames)
                                            {
                                                if (ViewBag.idTipoExame == e.TipoExameId)
                                                {
                                                    listExames.Add(new SelectListItem
                                                    {
                                                        Text = e.nomeExame,
                                                        Value = e.id.ToString()
                                                    });
                                                }
                                            }

                                            @Html.DropDownListFor(model => model.ExameId, listExames)
                                        }
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col mb-4">
                                    @Html.LabelFor(model => model.data, new { @class = "form-label", @style = "font-weight: bold" })
                                    <div class="form-outline datepicker">
                                        @{
                                            List<SelectListItem> listItems = new List<SelectListItem>();

                                            foreach (var d in ViewBag.datas)
                                            {
                                                listItems.Add(new SelectListItem
                                                {
                                                    Text = d.ToString(),
                                                    Value = d.ToString()
                                                });
                                            }

                                            @Html.DropDownListFor(model => model.data, listItems, "-- Selecione uma data --") <br />
                                            @Html.ValidationMessageFor(model => model.data, "", new { @class = "text-danger" })
                                        }
                                    </div>
                                </div>
                            </div>

                            <button type="submit" class="btn btn-success btn-lg mb-1">Enviar</button>
                        }
                    </div>
                </div>

                <script type="text/javascript">
                    document.getElementById("ExameId").value = "@exame.id"
                    document.getElementById("data").value = "@consulta.data"
                </script>

</section>